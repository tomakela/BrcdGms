<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image Gallery</title>
<script src="js/quagga.min.js"></script>
<link rel="stylesheet" href="style.css">
</head>
<body>

  <div id="scanner-container"></div>
  <div id="gallery"></div>

  <script src="js/quagga.min.js"></script>

<script>
        var _scannerIsRunning = false;

function startScanner() {
    const scannerContainer = document.querySelector('#scanner-container');
    const containerWidth = scannerContainer.offsetWidth; 
    const containerHeight = scannerContainer.offsetHeight; 
    Quagga.init({
        inputStream: {
            name: "Live",
            type: "LiveStream",
            target: document.querySelector('#scanner-container'),
            constraints: {
              width: 800,
              height: 600,
                //width: containerWidth,
                //height: containerHeight,
                facingMode: "environment"
            },
        },
        decoder: {
            readers: [
                "code_128_reader",
                "ean_reader",
                "ean_8_reader",
                "code_39_reader",
                "code_39_vin_reader",
                "codabar_reader",
                "upc_reader",
                "upc_e_reader",
                "i2of5_reader"
            ],
            debug: {
                showCanvas: true,
                showPatches: true,
                showFoundPatches: true,
                showSkeleton: true,
                showLabels: true,
                showPatchLabels: true,
                showRemainingPatchLabels: true,
                boxFromPatches: {
                    showTransformed: true,
                    showTransformedBox: true,
                    showBB: true
                }
            }
        },

    }, function (err) {
        if (err) {
            console.log(err);
            return
        }

        console.log("Initialization finished. Ready to start");
        Quagga.start();

        // Set flag to is running
        _scannerIsRunning = true;
    });


    Quagga.onDetected(function (result) {
        console.log("Barcode detected and processed : [" + result.codeResult.code + "]", result);
    });
}


const totalImages = 150; // Total number of images
const imagesPerColumn = 3; // Replace N with the desired number of images per column
const folderPath = 'img/'; // Path to the folder containing the images

function initGallery() {
  const gallery = document.getElementById('gallery');
  const rows = [];
  const numberOfRows = totalImages / imagesPerColumn;

  let row = null
  for (let i = 0; i < totalImages; i++) {
    item = document.createElement('div');
    item.className = 'gallery-item';
    const img = document.createElement('img');
    const hoverSrc = `${folderPath}${String(i).padStart(3, '0')}.png`; // Adjust the path as necessary
    const baseSrc = `${folderPath}${String(i).padStart(3, '0')}_mask.png`; // Adjust the path as necessary

    img.src = baseSrc;
    
    // Set hover effect
    img.addEventListener('click', () => img.src = hoverSrc);
    //img.addEventListener('mouseleave', () => img.src = baseSrc);

    item.appendChild(img);
    gallery.appendChild(item);

  }

  startScanner();
}

// Initialize the gallery when the page loads
window.onload = initGallery;
</script>

</body>
</html>
